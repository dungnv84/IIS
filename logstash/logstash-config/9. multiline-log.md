# cái này cho vào trong input, filter, output đều được

file {

    codec => multiline {
      pattern => "^(\s+|\t)|(Cause by:)"
      what => "previous"
      auto_flush_interval => 5
  }
}

1. codec => multiline: Đây là cách bạn khai báo rằng bạn muốn sử dụng plugin "multiline" để xử lý dữ liệu đa dòng.

2. "Cause by:": Đây là một từ khoá, nếu dòng chứa từ khoá này, Logstash sẽ coi đó là một dòng bắt đầu của sự kiện log mới.
Đây là biểu thức chính quy (regular expression) được sử dụng để xác định dòng bắt đầu của một sự kiện log mới. Khi một dòng log khớp với biểu thức chính quy này, Logstash sẽ coi nó là một dòng đầu tiên của một sự kiện log mới và bắt đầu xây dựng sự kiện log từ đó.

3. what => "previous": Đây là tùy chọn để chỉ ra Logstash sẽ xử lý dòng khớp với biểu thức chính quy là một dòng cuối (hay dòng trước đó) của sự kiện log. Nó có nghĩa là tất cả các dòng từ dòng bắt đầu đến dòng khớp với biểu thức chính quy sẽ được kết hợp lại để tạo thành một sự kiện log hoàn chỉnh.

4. auto_flush_interval => 5: Đây là tùy chọn để chỉ ra thời gian (tính bằng giây) Logstash sẽ tự động xây dựng một sự kiện log nếu nó chưa nhận được dòng kết thúc của sự kiện trong khoảng thời gian này. Nếu không có dòng kết thúc nào trong khoảng thời gian này, Logstash sẽ tự động tạo sự kiện log từ những dòng hiện có cho đến thời điểm đó.


match => [ "[time]", "MMM dd, yyyy HH:mm:ss a" ]